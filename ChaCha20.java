package obs1d1anc1ph3r.reverseshell.server.encryption;

import java.nio.charset.StandardCharsets;
import javax.crypto.Cipher;
import javax.crypto.spec.ChaCha20ParameterSpec;
import javax.crypto.spec.SecretKeySpec;
import java.security.SecureRandom;

public class ChaCha20 {

	private static final int NONCE_SIZE = 12;
	private static final int KEY_SIZE = 32;

	public static byte[] encrypt(byte[] key, byte[] nonce, byte[] message) throws Exception { //Encrypt that shit
		if (key.length != KEY_SIZE || nonce.length != NONCE_SIZE) { //Pedofile, not hat, you learn something new every day
			throw new IllegalArgumentException("Invalid key or nonce length");
		}

		Cipher cipher = Cipher.getInstance("ChaCha20"); //ChaCha is a great name
		ChaCha20ParameterSpec paramSpec = new ChaCha20ParameterSpec(nonce, 1);
		SecretKeySpec keySpec = new SecretKeySpec(key, "ChaCha20");

		cipher.init(Cipher.ENCRYPT_MODE, keySpec, paramSpec);
		return cipher.doFinal(message);
	}

	public static byte[] decrypt(byte[] key, byte[] nonce, byte[] ciphertext) throws Exception { //Decrypt that shit
		if (key.length != KEY_SIZE || nonce.length != NONCE_SIZE) {
			throw new IllegalArgumentException("Invalid key or nonce length");
		}

		Cipher cipher = Cipher.getInstance("ChaCha20");
		ChaCha20ParameterSpec paramSpec = new ChaCha20ParameterSpec(nonce, 1);
		SecretKeySpec keySpec = new SecretKeySpec(key, "ChaCha20");

		cipher.init(Cipher.DECRYPT_MODE, keySpec, paramSpec);
		return cipher.doFinal(ciphertext);
	}

	public static byte[] generateNonce() { //Yeah, do the thing
		byte[] nonce = new byte[NONCE_SIZE];
		new SecureRandom().nextBytes(nonce);
		return nonce;
	}

	public static byte[] stringToBytes(String str) {
		return str.getBytes(StandardCharsets.UTF_8);
	}

	public static String bytesToString(byte[] bytes) {
		return new String(bytes, StandardCharsets.UTF_8);
	}

}

/*


zz{{ííí{{{{{{{{———————————————————››—›››››››››››                                           › ››››››››››››››››››››››››››››››››››››››››—————————{——{{{{{{
ízíí{íí{{{{{{———————————————————›››› ›                          {  {{—                       › ››››››››››››››››››››››››››››››››››————————————————{{{{{—
ííí{{í{{{{{{—————————————————››                            —í{ {íí{                                ››››››››››››››››››››››——›››››››››››——————————{{{{{{—
ízí{{í{{{{{{————————›››››››››››                            {íííííí— í—                               ›››››››››››››››››››››››››››—››››—————————{{—{{{{{—
ííí{{{{{{{{——————————››››››››››                               {ííí ›í{›                            › ›››››››››››››››››››››››——››——›———————————ííz{{{{{—
ííí{{{{{{{{{————————›››—›››› ›                         G       —íz  ›   ›üÇ6Ï›                       ›››››››››››››››››››—›››—›———›—————————————{{{{{{{—
ííí{í{{{{{{——————————›—›››                    ÅÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÇ {—  Çííí{{íííízzzzg                   ››››››››››››—›››››››——————————————————————{{{{{——
íí{{í{{{{{———————————›››                  ÞÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅÆ › í{{í{{{ííííízzzzzzz{              › ››››››››››››››››—›››——————————————————————{{{{{——
ííííí{{{{{——————————›››—›               ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ üí{{›{í—{íííízzzzzzzzÏÏÇ               ›  ››››››››››››››››——————————————————————{{{{{——
ííííí{{{{{———————›››› ›››             ÆÆÆÆÆÆÆÆÆÆÆÅÅÆÆÆÆÆÅÅÆÆzÆÆü{ííí›››{íííGGGüzzzzzzÏü6ü                   ›››››››››››››››———————————————————{{{{{{{——
ííííí{{{{{———————››››››››           ÆÆíÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅÆÆÇÆÆgÇííííízízzG6ÏGÏzzÏÏÏÏüü666                  ››››››››››››—›››———————————{{{{{{{{{{{{{{——
íííííí{{{{—————››››››››››       6ÆÆ› GÆÆÆÆÆÆÆÆÆÆÆ—6—ÆÆÆÆÆÆÆÆÆÆ Åí{ííízzzzzÞGüÏÏÏ6üüüüüüüü6Ç              ››››››››››››››››››———{{{{{{{{{{{{—{{{{íí{{í{——
íííííí{{{{{———›››››››››››           íÆÆÆÆÆÆÆÆÆÆÆÆÆ{{—›ÆÆÆÆÆÆÆÅÏÅÅz{——66Þg6GÇG6ÞüüüüüüüüüüÇ6G                 ››››››››››››————{—{{{{{{í{{{—{{{{{í{{í{{——
íííííí{{{{{——››››››››››››           ÆÆÆÆÆÆÆÆÆÆÆÆÆÆ—g›ÞÆÆ——›Æ› ízG›—G{{{{ÏGÏÏ6üüüü6ü6üüüüü6GÇG              ›››››››››››››—————{—{{{{{{í{{{{{{{{{{{{{{{——
íííííí{{{{———›››››››››››            ÆÆÆÆÆÆÆÆÆÆÆÆÆgÆ—ÆÆÆÆ6Ç—ÆÏ—{ ÇÇ{ííí{—üüÞüüüÞü666G6666ü66g6g               ››››››››››››————{—{—{{{{{{{{{{{{{{{{{{í———
í{ííí{{{{{——›››››››››››››           ÆÆÆÆÆÆÆÆÆÆÆÆ  ›——ÞÆÆ—Ç›g———›››—›››› G6Þ6ü6üü666666ÇÇ6666G6Ç6            ›››››››››››››————————{{{{{{{{{{{{{{{{{{{{——
{{{{{{{{————›››››››››››››           ÆÆÆÆÆÆÆÆÆÆÆÆ—————{—Æ—g›Æ    z››  ››  ÞüÞÞ6Þ66Þ6ÇÇÇÞÇÇÇÇ6Ç{›GÇÇÞ        ››››››››››››››—————{—{{{{{{{{{{{{{{{{{{{{———
{{{{{{{—————›››››››››››››           ÆÆÆÆÆÆÆÆÆÆÆÆ{————————›{     —       ›››Ç6gÇGÇÇÇÞÇÇÇÞÇÇÇÇÇÇ{              ›››››››››››››——————{{{{{{{{{{{{{{{{{{{{{——
{{{{{——————››››››››››››››           ÆÆÆÆÆÆÆÆÆÆÆÆÆ››››————      üzÇ›       ›gÏÏzÇGÇÇÇGÇÇÇÇÇÇÇÇGÇ6             ›››››››››››››——————{{{{{{{{{{{{{{{{{{{{{——
{{{{———————››››››››››››››           ÆÆÆÆÆÆÆÆÆÆÆÆízz››››››       ü›     —ÇÏÏÏÏÏzÞÞgÇÇÇÞÇÇÇÇÇÇÇÇGÇg            ›››››››››››››——————{{{{{{{{{{{{{{{{{{{{{——
{{{{————————››››››››››››››         GÆÆÆÆÆÆÆÆÆÆÆÆ{{ÆÆz›››››üÇ     G{{{íÏÏÏÏÏÅÆÆÆÆÆÅíÇÇÇÇÇÇÞÇÇÇÇÇíÇÞ           ›››››››››››››——————{{{{{{{{{{{—{{{{{{{{———
{{{————————››››››››››››››          Æ›ÆÆÆÆÆÆÆÆÆügí{ÆÆÆÏ››› {            ÅÏÅÆÆÆÆÆÆÆÆÆÆÇÇÞÇÇÇÇÇÇÇÇÞ›ÇÇ          ›››››››››››››————————{{{{{—————{{{{{{{————
{{{————————››››››››››››››          Æ ÆÆÆÆÆÆÆí Æ{{6ÆÆÆ{›››› 6            ÆÆÆÆÆÆÆÆÆÆÆÆÆÇÇGÇÇÇÇÇÇÇÇg—ÇÞ          ››››››››››››——————{—{—{{{—————{—{{{——————
{—————————››››››››››››››››         ÆÏÆÆÆÆÆÆ› Çü{{ÞÆÆÆ{í››››            ÆÆÆÆÆÆÆÆÆÆÆÆÆÆgÇÇÇÇÇÇÇÇÇÇÇ6ÇÇG         ››››››››››››————————{——{{————————{{——————
{—————————›››››››››››››››           ÆÆÆÆÆÆí{ÅÅÅÅÅÅÆÆÆ 6Ç››› —         ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÇÇÇÇÇÇ66ÇÇÇÇ{Ç6         ›››››››››››———————{—{——{—————————{{——————
——————————››››››››››››››››           zÆÆÆÆÅÆí{{{{—ÅÆÆ{Ï {››› {      ÞÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆGÇÇÇÇ6666ÇÇÇ6GÇ          ›››››››››››——————{——{——{————————{{{—————
››————————››››››››››››››››            Æ›gÆÆ—{{{{{{ ÅÆÆ ›ü›››  6    ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÇÇ6666666ÇÇÇg66         ›››››››››››————————{{———————————{—{—————
››————————›››››››››››››››            —ÆÆÆÅG—{{{{{{ —ÅÆÆ  ››››  Ï   ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆG666666666ÇÇ66G          ›››››››››——————————————————————————————
  ››››———›››››››››››››››››          ÆÆÆÆÆÅÇ———————— gÅÆÇ z››››  {6ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ6üüüü66666ÇÇ6gÞ           ››››››››››—————————————————————{——————
  ››››———››››››››››››››› ›        6ÆÆÆÆÆÆÅz———{{——— íÆÅÅÆgí›››   Ç6ÏíÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅüüüüüüü66ÇÇÇ66g        ›  ››››››››—›————————————————————————————
 ›››››—›—›››››››››››››››         ÆÆÆÆÆÆÆÆÅÞz›—————— —›Ågggg››››  —ü {GÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆgÏÏÏÏÏüüüü6666ÇÇ›           ››››››››—›————————————————————————————
 ›››››››››››››››››››››››       ÆÆÆÆÆÆÆÆÆÆÆÆ›››——›››  ›{ggggÞ›››› — ››{ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ6Çüüüüüüüüüü66ÞÇG        ›  ››››››››—›————————————————————————————
 ›››››››››››››››››››››››      ÆÆÆÆÆÆÆÆÆÆÆÆg››››  ››   gggggg ›››››››››íÆÆÆÆÆÆÆÆÆÆÆÆÆG6Þüüüü66ü6ü66ÇÇÇÞ            ›››››››››—————————————————————————›——
›››››››››››››››››››››››     ›ÆÆÆÆÆÆÆÆÆÆÆÆÆGüü    ›   gÅggggÅÅ ››››››››ÅÆÆÆÆÆÆüÆÆÆÆÆÏz6Ç6666666666ÇÇÇÞÇ            ››››››››——————————————————————————›››
›››››››››››››››››››››››    ÞÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅgg        ÅGGgÅÅÅÅ{›››››››gggÆÆÆÆÆ ÆÆÆÆÆ—›Ç666ÇÇ66ÇÇÇÇÇÇÇGÇí           ››››››››››—›————————————————————›››››
›››››››››››››››››››››››   ÅÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆGÅ        gÅÅÅÅÅÅÅÅ››——››ggÆÆÆÆÆÆ íÆÆÆí—Ç—ÇÇÇÇ6ÇÇÇÇÇÇÇÇÇÇgÇg           › ››››››››—›————————————————————›››—›
›››››››››››››››››››››››  ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆGÇ       gÅÅÅÅÅÅÅÅÅÇ›—GÆÅÆÆÆÆÆÆ—   ›››Æ{{ÏÇÇÇÇÇÇÇÇÇÇÇÇÇÇ{Çg           ›››››››››››—›—————————————————›››››››
›››››››››››››››››  ›››› ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ gÅ       gÅÅÅÅÅÅÅÅÅÅ —ÏÅÅÆÅÅÆÆÆ   ››››—zz{ÇÇÞÇÇÇÇÇÇÇÇÇÇÇ Çg  ›  ››     ››› ›››››—››————————————————›››——›››
›››››››› ››››››››  ›› ›üÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ —Þ{      gÅÅÅÅÅÅÅÅÅÅ ÅgÅÅÆÅÅÆ—    ›››—›—Ç GÇÇÇÇÇÇÇÇGÇÇÇÇ Çg ›››  ›         ›››››—›—›—————————›—›———›››—››—›
››››››››››››››››    ›  ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ{ ›Ï      gÅÅÅÅÅÅÅÅggGí             ›››ÆÆÆ ÇÇÇGÇÇÇÇÇÞÇÇÇÞ Ç—      ››           ›››››››—›››—››››››››››—››››—›
›››››››››››››››› ›    ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  z      ÞÅÆG—                 ÆÆÆÆÆÆÆÆÆÆÆgÇÇÇÇÇÇÇÇÇÞÇÇÞ—Ç                  › ›››››››››››››››››››››—››—››››
›››››››››››››› ›  ›   ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ                      › ›› —ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÇÇÇÞÇÇÇÇÇgÇÇGGg                   ›››››››››››››››—›››—››—››—››—›
››››››››››››››       ›—ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  Ï                   ›ÆÆÆÆÆÆÆÆÆÆÇííí— ›› ÇÇÞÇÞÇÇÇÇÞÇÇGG—                   ››››››››››››››››››—›››››››››››
›››››››››   ›        zÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  Å               üÆ ÆÆÆÆÆÆÆÇü{{{—    {G{›   {gÞÞÇÇÇgÇÞ                    ››››››››››››››››››—››——››—›——››
››››››››   ›  ›      zÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  ÅÅg        zgÅÅÆÆÅ ›í{{{{{———››G› ›››››———››  GÞÞÇÞÇÇ                        ››››››››››—›——›››—››—››››››
››››››› ›             ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ› íÆÆÅÆÆÆÅÅÅÅÅÅÅÆÆÆÅÆ ——————6—      ››››————————›—ÞÞÇgÞG                         ›››››››››››››››››››››—›—›
››››››      ›         ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ6 ÆÆÆÆÅÅÅÅÆÅÆÆÅÅÅÅÅÆ6  GÞ           ››››{{{—{{———› ÞÞÞÞÞ                        ›››››››—›—››—››—››—››—›——›
›››  ››  ›            ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅ gÅÆÆÅÅÅÅÅÅÆz{{{› Ïü              ››—{{{{{{{{{——››gÞÞGÞÅ                   ›   ››››››››—››——››—››—››››—›—
  ›                   ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  —í——{{{—    —Ï                 ›{{{{{{{{Þ{{{——›  ÞÞÞ—Þ{                   ›  ››››—›››››››››››››—››——›——
  ›› ›                ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ G————››› ÏÆ                   ›————{{{ÇÞÞÞü————›› ÅÞÞ{ Þ             ›  ›      ›››››››››—››—››—››——››———
                       ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅ Æ››››6ÅgÅ                 ›››————{{{gÇÇÇÞÞg————›› zÞÞg ›Å            ›  ›     ››››››››››››››—›—››——›————
                       6ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ6 ÆgggggÅ                  ›››——————gÇÇÇÇÇÇÇÞz{—›››› gÞG                         ››››› ››››››—››——›———————
                        ÅÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  ÆggggÅ—————————››      ›››——›———gzzííí{GÇGÇÅ{›—————›ÞG                         ›››››››››››››››——————————
                         ÏÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ  ÆgggÅ—————————————›› ››——————›Gzzíííí{——g66 6—————— gG ü   ›                  ›››› ››››››››——›——————————
   ›                       ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÅ  ÆggÅ{—{——————›——————››—————›{ízííííí———Åüüü›Þ6———{{{ GÏ›—  {›           ›     ›››››››››—›———›———————————
                            ÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ   ígÅ{{{{{{{———————————››—›› Çíííz{{í—››Çüüg GÞGÏ—{{{z Åüüü Å  ›—         › ›› ››››››››››››——›————————————
                            íÆÆÆÆÆÆÆÆÆÆÆÆÆÆÆ    ÅÅ{{{{{{{{{—————————››  gíííííí{{››››ü6Ç ÇÞGÞGí{{{íü Þüüü  Ï ››—        › ›››››››››››——›———————————————
                             Æ{ÆÆÆÆÆÆÆÆÆÆÆÆ      í{{{{{{{{{{{——{———— —Åííííííí{{››››6ü6Ç ÞÞgÞÞÞ{{{{zí üüüüü›{  {        › ››››››››››››—›———————————————
                             ÇÏÆÆÆÆÆÆÆÆÆÆÆ6       g{{{{{{{{{———————›Åííííííííí——››››ÇüüÇgÞÞÞÞÞgG{íííí—ÅüüüüüÏ›z ››{     › ››››››››››››—————————————————
                              üÆÆÆÆÆÆÆÆÆÆÆ          Å—{{{{{{{{{——Ï   Ïíííííííí{{  ›{ÇüügGÞgÞÞÞgGGí{{{{{6üÏÏÏíííí{Ï  ›í  › ››››››››››››—————————————————
                               ÆÆÆÆÆÆÆÆÆÆÏ              6gÏ{{ÏÅ      gíííííííí{{   ÏGÏÏÅÞÞgÞÞÞG  gííííí{  gíííí{{{{›g {    ›››››››››››—————————————————
                               ÆÆÆÆÆÆÆÆÆÆ                            zíííííííí{— ››ÏÅÏÏÇGÞÅÞÞÞg   ÇzzzzzzgG Þ—Ç{{———››››zÏ › ›››››››››—————————————————
                               {ÆÆÆÆÆÆÆÆÆ                             {íííííí{{›  ›{ÇÏÏí ggÞÞÞÅ    zzzzzzzzzzÇ›G››—››       —6›››››—›››—›——————————————
   ›  ›››                       ÆÆÆÆÆÆÆÆÆ›                            zíízzzí{{›  ›ÇÏÏüz   gÞÞ—    ÞzzzzzzzzzzÇ››——›››            í—›ü{————————————————
› ›››››››                       ÆÆÆÆÆÆÆÆÆÆ                            Åzzzzzzí—›  —ÅÏüÏ—    gÞg     6zzzzzzzzz6ü—›››››   ›         ÇÏ—6›———————————————
››››››››››››››››› ›             ÞÆÆÆÆÆÆÆÆÆ                            ›zzzzzzz—›› ÏÅÏü6       g     {zzzzzzzÇzÆÏÅí›››{Þ     ››zü{›››››››———————————————
››››››››››››››››››               ÆÆÆÆÆÆÆÆÆÆ                            Åzzzzzz—  ›6gÏÏÅ              {Çzzzü                ››››››››››››————————————————
›››››››››››››››››››› ›  ›     ›   ÆÆÆÆÆÆÆÆÆÞ                           üzzzzz{   —ÏÏüÏg                                    › ››››››————————————————————


*/
